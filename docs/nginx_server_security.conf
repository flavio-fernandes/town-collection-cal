# Example Nginx server-block hardening for the HTTPS virtual host.
# Place these inside the `server { ... }` block that listens on 443.
# For Option 1 routing, apply rate limits to API locations only.

add_header X-Content-Type-Options nosniff always;
add_header X-Frame-Options DENY always;
add_header Referrer-Policy no-referrer always;
add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always;

location ~ ^/(town\.ics|resolve|version|healthz|debug|streets)$ {
    limit_req zone=ics_rate burst=20 nodelay;
    limit_conn addr 20;
}
